<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candidature - UCAO-UUC</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Styles CSS -->
    <link rel="stylesheet" href="/assets/css/components/candidate-card.css">
    <link rel="stylesheet" href="/assets/css/pages/candidature.css">
</head>

<body>
    <header>
        <div class="logo"><i class="fa-solid fa-graduation-cap"></i> UCAO-UUC</div>
        <div class="user-nav">
            <span><i class="fa-solid fa-user"></i> <span id="userName">Étudiant</span></span>
            <a href="/user/profile"><i class="fa-solid fa-user"></i> Profil</a>
            <a href="#" id="logoutBtn"><i class="fa-solid fa-right-from-bracket"></i> Déconnexion</a>
        </div>
        <div class="burger" id="burger">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </header>

    <div class="overlay" id="overlay"></div>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <div class="dashboard-container">
        <aside class="sidebar" id="sidebar">
            <ul class="sidebar-menu">
                <li><a href="dashboard.html"><i class="fa-solid fa-house"></i> Accueil</a></li>
                <li><a href="candidature.html" class="active"><i class="fa-solid fa-file-signature"></i>
                        Candidature</a></li>
                <li><a href="elections.html"><i class="fa-solid fa-list"></i> Élections</a></li>
                <li><a href="mes-candidatures.html"><i class="fa-solid fa-list"></i> Mes Candidatures</a></li>
                <li><a href="vote.html"><i class="fa-solid fa-check"></i> Voter</a></li>
                <li><a href="resultats.html"><i class="fa-solid fa-chart-bar"></i> Résultats</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <!-- Breadcrumb -->
            <div class="breadcrumb">
                <a href="dashboard.html"><i class="fa-solid fa-house"></i> Accueil</a>
                <i class="fa-solid fa-chevron-right"></i>
                <span>Candidature</span>
            </div>

            <!-- Message d'état quand aucune élection n'est spécifiée -->
            <div class="state-message" id="noElectionMessage">
                <div class="state-icon">
                    <i class="fa-solid fa-hand-point-right"></i>
                </div>
                <h2 class="state-title">Aucune élection sélectionnée</h2>
                <p class="state-description">
                    Pour soumettre une candidature, vous devez d'abord sélectionner une élection.
                    Veuillez choisir une élection dans la liste disponible.
                </p>
                <div class="state-actions">
                    <a href="elections.html" class="btn btn-primary">
                        <i class="fa-solid fa-list"></i>
                        Voir les élections
                    </a>
                    <a href="dashboard.html" class="btn btn-secondary">
                        <i class="fa-solid fa-house"></i>
                        Retour à l'accueil
                    </a>
                </div>
            </div>

            <!-- Candidature Header -->
            <div class="candidature-header" id="candidatureHeader">
                <h1 class="candidature-title" id="electionTitle">Déposer sa candidature</h1>
                <p class="candidature-subtitle" id="electionSubtitle">Remplissez le formulaire pour soumettre votre
                    candidature</p>
            </div>

            <!-- Indicateur de chargement -->
            <div class="loading-state" id="loadingState">
                <div class="spinner"></div>
                <p>Chargement des informations de l'élection...</p>
            </div>

            <!-- Eligibility Alert -->
            <div class="eligibility-alert" id="eligibilityAlert">
                <div class="alert-title">
                    <i class="fa-solid fa-exclamation-triangle"></i>
                    Non éligible
                </div>
                <div class="alert-description" id="eligibilityMessage">
                    Vous n'êtes pas éligible pour cette élection.
                </div>
                <div class="alert-actions">
                    <a href="elections.html" class="btn btn-secondary">
                        <i class="fa-solid fa-arrow-left"></i>
                        Retour aux élections
                    </a>
                </div>
            </div>

            <!-- Candidature Form -->
            <div class="form-section" id="candidatureForm">
                <h2 class="form-title"><i class="fa-solid fa-pen-to-square"></i> Formulaire de candidature</h2>

                <form id="candidatureFormElement">
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label">Élection</label>
                            <input type="text" class="form-input" id="electionName" readonly>
                        </div>

                        <div class="form-group">
                            <label for="slogan" class="form-label required">Slogan de campagne</label>
                            <input type="text" id="slogan" class="form-input" placeholder="Votre slogan accrocheur"
                                required maxlength="100">
                            <div class="form-help">Maximum 100 caractères</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label required">Photo de profil</label>
                            <div class="image-upload">
                                <div class="upload-area" id="uploadArea">
                                    <div class="upload-icon">
                                        <i class="fa-solid fa-cloud-arrow-up"></i>
                                    </div>
                                    <div class="upload-text">Glissez-déposez votre photo ici ou cliquez pour
                                        sélectionner</div>
                                    <div class="upload-hint">Formats acceptés: JPG, PNG (max. 2MB)</div>
                                    <input type="file" id="photoUpload" accept="image/jpeg,image/png"
                                        style="display: none;">
                                </div>
                                <div class="upload-preview" id="uploadPreview">
                                    <img src="" alt="Aperçu" class="preview-image" id="previewImage">
                                    <div class="remove-image" id="removeImage">Supprimer l'image</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group full-width">
                            <label for="program" class="form-label required">Programme électoral</label>
                            <textarea id="program" class="form-textarea"
                                placeholder="Décrivez votre programme, vos propositions et vos engagements..." required
                                minlength="50" maxlength="2000"></textarea>
                            <div class="form-help">Minimum 50 caractères, maximum 2000 caractères</div>
                        </div>

                        <div class="form-group full-width">
                            <label for="motivation" class="form-label required">Lettre de motivation</label>
                            <textarea id="motivation" class="form-textarea"
                                placeholder="Expliquez pourquoi vous êtes le meilleur candidat pour ce poste..."
                                required minlength="100" maxlength="1000"></textarea>
                            <div class="form-help">Minimum 100 caractères, maximum 1000 caractères</div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelBtn">
                            <i class="fa-solid fa-xmark"></i>
                            Annuler
                        </button>
                        <button type="submit" class="btn btn-primary" id="submitBtn">
                            <i class="fa-solid fa-paper-plane"></i>
                            Soumettre ma candidature
                        </button>
                    </div>
                </form>
            </div>

            <!-- Section Liste des Candidats -->
            <div class="form-section" id="candidatesSection">
                <h2 class="form-title"><i class="fa-solid fa-users"></i> Candidats à cette élection</h2>

                <div id="candidatesList">
                    <div class="loading" id="candidatesLoading">
                        <div class="spinner"></div>
                        <p>Chargement des candidats...</p>
                    </div>
                </div>

                <div class="empty-state" id="noCandidatesMessage">
                    <i class="fa-solid fa-user-slash"></i>
                    <h3>Aucun candidat pour le moment</h3>
                    <p>Soyez le premier à postuler pour cette élection !</p>
                </div>
            </div>

            <!-- Status Message -->
            <div class="status-message" id="statusMessage">
                <div class="status-icon">
                    <i class="fa-solid fa-hourglass-half"></i>
                </div>
                <h2 class="status-title">Candidature en attente de validation</h2>
                <p class="status-description">
                    Votre candidature a été soumise avec succès et est maintenant en attente de validation par
                    l'administration. Vous serez notifié par email une fois que votre candidature aura été examinée.
                </p>
                <div class="status-actions">
                    <a href="dashboard.html" class="btn btn-primary">
                        <i class="fa-solid fa-house"></i>
                        Retour à l'accueil
                    </a>
                    <a href="mes-candidatures.html" class="btn btn-secondary">
                        <i class="fa-solid fa-list"></i>
                        Voir mes candidatures
                    </a>
                    <a href="elections.html" class="btn btn-secondary">
                        <i class="fa-solid fa-list"></i>
                        Voir les autres élections
                    </a>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal pour les détails du candidat -->
    <div class="candidate-modal" id="candidateModal">
        <div class="candidate-modal-content" id="candidateModalContent"></div>
    </div>

    <div class="toast" id="toast">
        <i class="fa-solid fa-circle-check" id="toastIcon"></i>
        <span id="toastMessage"></span>
    </div>

    <!-- Chargement des scripts -->
    <script src="/assets/js/config.js"></script>
    <script src="/assets/js/utils/api.js"></script>
    <script src="/assets/js/services/eligibilityService.js"></script>
    <script src="/assets/js/services/electionService.js"></script>
    <script src="/assets/js/services/candidateService.js"></script>
    <script src="/assets/js/components/CandidateCard.js"></script>
    <script src="/assets/js/main.js"></script>

    <script>
        // Variables globales pour cette page
        let currentElection = null;
        let uploadedImageUrl = null;
        let electionCandidates = [];

        // Initialisation de la page
        document.addEventListener('DOMContentLoaded', async function () {
            // Vérifier que l'utilisateur est connecté
            if (!localStorage.getItem('token')) {
                window.location.href = '/user/login';
                return;
            }

            // Masquer tous les états initialement
            hideAllSections();

            // Vérifier si une élection est spécifiée dans l'URL
            const urlParams = new URLSearchParams(window.location.search);
            const electionId = urlParams.get('electionId') || urlParams.get('election');

            if (!electionId) {
                showNoElectionMessage();
                return;
            }

            // Charger les détails de l'élection
            await loadElectionDetails(electionId);

            // Initialiser les gestionnaires d'événements
            initEventHandlers();
        });

        // Masquer toutes les sections
        function hideAllSections() {
            document.getElementById('noElectionMessage').style.display = 'none';
            document.getElementById('candidatureHeader').style.display = 'none';
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('eligibilityAlert').style.display = 'none';
            document.getElementById('candidatureForm').style.display = 'none';
            document.getElementById('candidatesSection').style.display = 'none';
            document.getElementById('statusMessage').style.display = 'none';
        }

        // Afficher le message d'absence d'élection
        function showNoElectionMessage() {
            hideAllSections();
            document.getElementById('noElectionMessage').style.display = 'block';
        }

        // Charger les détails de l'élection
        async function loadElectionDetails(electionId) {
            showLoading();
            document.getElementById('loadingState').style.display = 'flex';

            try {
                // Charger les détails de l'élection
                currentElection = await ElectionService.getElectionDetails(electionId);

                if (!currentElection) {
                    throw new Error('Élection non trouvée');
                }

                // Mettre à jour l'interface avec les détails de l'élection
                updateElectionDetails(currentElection);

                // Vérifier l'éligibilité
                await checkEligibility(currentElection);

                // Charger les candidats de cette élection
                await loadElectionCandidates(currentElection.id);

            } catch (error) {
                console.error('Erreur chargement détails élection:', error);
                showToast('Impossible de charger les détails de l\'élection', 'error');
                showNoElectionMessage();
            } finally {
                hideLoading();
                document.getElementById('loadingState').style.display = 'none';
            }
        }

        // Mettre à jour les détails de l'élection dans l'interface
        function updateElectionDetails(election) {
            document.getElementById('electionTitle').textContent = `Candidature: ${election.titre}`;
            document.getElementById('electionSubtitle').textContent = `Poste de ${ElectionService.getDelegueTypeLabel(election.delegueType)} - ${ElectionService.getElectionTypeLabel(election.type)}`;
            document.getElementById('electionName').value = election.titre;

            // Afficher l'en-tête
            document.getElementById('candidatureHeader').style.display = 'block';
        }

        // Vérifier l'éligibilité du candidat
        async function checkEligibility(election) {
            try {
                // Vérifier si déjà candidat
                const isAlreadyCandidate = await CandidateService.isCandidate(election.id);

                if (isAlreadyCandidate) {
                    showEligibilityError('Vous êtes déjà candidat à cette élection.');
                    return;
                }

                // Vérifier l'éligibilité avec le service
                const isEligible = EligibilityService.canCandidateInElection(window.userProfile, election);

                if (!isEligible) {
                    const message = EligibilityService.getEligibilityMessage(window.userProfile, election);
                    showEligibilityError(message);
                    return;
                }

                // Si éligible, afficher le formulaire
                showCandidatureForm();

            } catch (error) {
                console.error('Erreur vérification éligibilité:', error);
                showEligibilityError('Erreur lors de la vérification d\'éligibilité');
            }
        }

        // Afficher le message d'erreur d'éligibilité
        function showEligibilityError(message) {
            hideAllSections();
            document.getElementById('candidatureHeader').style.display = 'block';
            document.getElementById('eligibilityAlert').style.display = 'block';
            document.getElementById('eligibilityMessage').textContent = message;
        }

        // Afficher le formulaire de candidature
        function showCandidatureForm() {
            hideAllSections();
            document.getElementById('candidatureHeader').style.display = 'block';
            document.getElementById('candidatureForm').style.display = 'block';
            document.getElementById('candidatesSection').style.display = 'block';
        }

        // Charger les candidats de l'élection
        async function loadElectionCandidates(electionId) {
            const container = document.getElementById('candidatesList');
            const loadingElement = document.getElementById('candidatesLoading');
            const emptyElement = document.getElementById('noCandidatesMessage');

            if (!container) return;

            loadingElement.style.display = 'flex';
            emptyElement.style.display = 'none';
            container.innerHTML = '';

            try {
                const response = await CandidateService.getCandidates(electionId);

                if (response && response.candidates && response.candidates.length > 0) {
                    electionCandidates = response.candidates;
                    renderCandidatesList(electionCandidates);
                } else {
                    showNoCandidates();
                }
            } catch (error) {
                console.error('Erreur chargement candidats:', error);
                showNoCandidates();
            } finally {
                loadingElement.style.display = 'none';
            }
        }

        // Afficher la liste des candidats
        function renderCandidatesList(candidates) {
            const container = document.getElementById('candidatesList');
            const emptyElement = document.getElementById('noCandidatesMessage');

            if (!container) return;

            if (!candidates || candidates.length === 0) {
                showNoCandidates();
                return;
            }

            emptyElement.style.display = 'none';

            container.innerHTML = `
                <div class="candidates-grid">
                    ${candidates.map(candidate =>
                CandidateCard.create(candidate, {
                    showProgram: true,
                    showViewProfile: true
                })
            ).join('')}
                </div>
            `;

            // Ajouter les événements de clic pour voir les détails
            attachCandidateEventHandlers();
        }

        // Afficher le message d'absence de candidats
        function showNoCandidates() {
            const container = document.getElementById('candidatesList');
            const emptyElement = document.getElementById('noCandidatesMessage');

            if (container && emptyElement) {
                container.innerHTML = '';
                emptyElement.style.display = 'block';
            }
        }

        // Attacher les gestionnaires d'événements aux candidats
        function attachCandidateEventHandlers() {
            // Gestionnaire pour les cartes de candidats
            document.querySelectorAll('.candidate-card').forEach(card => {
                card.addEventListener('click', function () {
                    const candidateId = this.dataset.candidateId;
                    const candidate = electionCandidates.find(c => c.id == candidateId);

                    if (candidate) {
                        showCandidateDetails(candidate);
                    }
                });
            });

            // Gestionnaire pour les liens "Voir profil"
            document.querySelectorAll('.view-program-link').forEach(link => {
                link.addEventListener('click', function (e) {
                    e.stopPropagation();
                    const candidateId = this.closest('.candidate-card').dataset.candidateId;
                    const candidate = electionCandidates.find(c => c.id == candidateId);

                    if (candidate) {
                        showCandidateDetails(candidate);
                    }
                });
            });
        }

        // Afficher les détails d'un candidat
        function showCandidateDetails(candidate) {
            const modal = document.getElementById('candidateModal');
            const content = document.getElementById('candidateModalContent');

            if (!modal || !content) return;

            content.innerHTML = `
                <span class="close-modal" onclick="closeCandidateModal()">&times;</span>
                
                <div class="candidate-modal-header">
                    <img src="${candidate.photoUrl || 'https://via.placeholder.com/100'}" 
                         alt="${candidate.prenom} ${candidate.nom}" 
                         class="candidate-modal-image"
                         onerror="this.src='https://via.placeholder.com/100'">
                    <div class="candidate-modal-info">
                        <h2 class="candidate-modal-name">${candidate.prenom} ${candidate.nom}</h2>
                        <div class="candidate-modal-slogan">"${candidate.slogan}"</div>
                        <div>
                            <strong>${candidate.filiere || 'Non spécifié'}</strong> - 
                            Année ${candidate.annee || 'N/A'}
                        </div>
                    </div>
                </div>

                <div class="candidate-modal-section">
                    <h4><i class="fa-solid fa-book"></i> Programme électoral</h4>
                    <div class="candidate-modal-content-text">${candidate.programme || 'Aucun programme disponible'}</div>
                </div>

                <div class="candidate-modal-section">
                    <h4><i class="fa-solid fa-heart"></i> Motivation</h4>
                    <div class="candidate-modal-content-text">${candidate.motivation || 'Aucune motivation disponible'}</div>
                </div>
            `;

            modal.style.display = 'flex';
        }

        // Fermer la modale des détails du candidat
        function closeCandidateModal() {
            const modal = document.getElementById('candidateModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // Initialiser les gestionnaires d'événements
        function initEventHandlers() {
            // Gestionnaire de formulaire
            document.getElementById('candidatureFormElement').addEventListener('submit', handleFormSubmit);

            // Gestionnaire d'annulation
            document.getElementById('cancelBtn').addEventListener('click', handleCancel);

            // Gestionnaire d'upload d'image
            initImageUploadHandlers();

            // Gestionnaire de la modale
            document.getElementById('candidateModal').addEventListener('click', function (e) {
                if (e.target === this) {
                    closeCandidateModal();
                }
            });
        }

        // Initialiser les gestionnaires d'upload d'image
        function initImageUploadHandlers() {
            const uploadArea = document.getElementById('uploadArea');
            const photoUpload = document.getElementById('photoUpload');
            const uploadPreview = document.getElementById('uploadPreview');
            const previewImage = document.getElementById('previewImage');
            const removeImage = document.getElementById('removeImage');

            if (!uploadArea || !photoUpload) return;

            uploadArea.addEventListener('click', () => {
                photoUpload.click();
            });

            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                if (e.dataTransfer.files.length > 0) {
                    handleImageUpload(e.dataTransfer.files[0]);
                }
            });

            photoUpload.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleImageUpload(e.target.files[0]);
                }
            });

            if (removeImage) {
                removeImage.addEventListener('click', () => {
                    uploadPreview.style.display = 'none';
                    uploadArea.style.display = 'block';
                    uploadedImageUrl = null;
                    photoUpload.value = '';
                });
            }
        }

        // Gérer l'upload d'image
        async function handleImageUpload(file) {
            const allowedTypes = ['image/jpeg', 'image/png'];
            if (!allowedTypes.includes(file.type)) {
                showToast('Format de fichier non supporté. Utilisez JPG ou PNG.', 'error');
                return false;
            }

            if (file.size > 2 * 1024 * 1024) {
                showToast('L\'image ne doit pas dépasser 2MB.', 'error');
                return false;
            }

            showImageUploadLoading();

            try {
                // Créer un aperçu local
                const previewUrl = URL.createObjectURL(file);
                document.getElementById('previewImage').src = previewUrl;
                document.getElementById('uploadPreview').style.display = 'block';
                document.getElementById('uploadArea').style.display = 'none';

                // Uploader l'image
                const formData = new FormData();
                formData.append('image', file);

                const token = localStorage.getItem('token');
                const response = await fetch(CONFIG.API.ENDPOINTS.UPLOAD.IMAGE, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('Échec de l\'upload');
                }

                const data = await response.json();
                uploadedImageUrl = data.url;

                showToast('Image téléchargée avec succès', 'success');
                return true;

            } catch (error) {
                console.error('Erreur upload:', error);
                resetImageUpload();
                showToast('Erreur lors du téléchargement de l\'image', 'error');
                return false;
            }
        }

        // Afficher le loading pendant l'upload
        function showImageUploadLoading() {
            const uploadArea = document.getElementById('uploadArea');
            if (uploadArea) {
                uploadArea.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666;">
                        <div class="loading-spinner" style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--or); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                        <div>Téléchargement en cours...</div>
                    </div>
                `;
            }
        }

        // Réinitialiser l'upload d'image
        function resetImageUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const uploadPreview = document.getElementById('uploadPreview');

            if (uploadArea) {
                uploadArea.innerHTML = `
                    <div class="upload-icon">
                        <i class="fa-solid fa-cloud-arrow-up"></i>
                    </div>
                    <div class="upload-text">Glissez-déposez votre photo ici ou cliquez pour sélectionner</div>
                    <div class="upload-hint">Formats acceptés: JPG, PNG (max. 2MB)</div>
                    <input type="file" id="photoUpload" accept="image/jpeg,image/png" style="display: none;">
                `;
                uploadArea.style.display = 'block';
            }

            if (uploadPreview) {
                uploadPreview.style.display = 'none';
            }

            // Réinitialiser les événements
            initImageUploadHandlers();
        }

        // Gérer la soumission du formulaire
        async function handleFormSubmit(e) {
            e.preventDefault();

            // Validation
            if (!validateForm()) {
                return;
            }

            showLoading();

            try {
                const formData = {
                    electionId: currentElection.id,
                    slogan: document.getElementById('slogan').value,
                    photo: uploadedImageUrl,
                    programme: document.getElementById('program').value,
                    motivation: document.getElementById('motivation').value,
                    statut: 'en_attente'
                };

                const response = await CandidateService.submitCandidature(formData);

                if (response && response.success) {
                    showSuccessMessage();
                } else {
                    throw new Error(response?.message || 'Erreur lors de la soumission');
                }

            } catch (error) {
                console.error('Erreur soumission candidature:', error);
                showToast(error.message || 'Erreur lors de la soumission de la candidature', 'error');
            } finally {
                hideLoading();
            }
        }

        // Valider le formulaire
        function validateForm() {
            const slogan = document.getElementById('slogan').value;
            const program = document.getElementById('program').value;
            const motivation = document.getElementById('motivation').value;

            if (!uploadedImageUrl) {
                showToast('Veuillez uploader une photo de profil', 'error');
                return false;
            }

            if (!slogan || !program || !motivation) {
                showToast('Veuillez remplir tous les champs obligatoires', 'error');
                return false;
            }

            if (slogan.length > 100) {
                showToast('Le slogan ne doit pas dépasser 100 caractères', 'error');
                return false;
            }

            if (program.length < 50 || program.length > 2000) {
                showToast('Le programme doit contenir entre 50 et 2000 caractères', 'error');
                return false;
            }

            if (motivation.length < 100 || motivation.length > 1000) {
                showToast('La motivation doit contenir entre 100 et 1000 caractères', 'error');
                return false;
            }

            return true;
        }

        // Afficher le message de succès
        function showSuccessMessage() {
            hideAllSections();
            document.getElementById('statusMessage').style.display = 'block';
        }

        // Gérer l'annulation
        function handleCancel() {
            if (confirm('Êtes-vous sûr de vouloir annuler ? Toutes les modifications seront perdues.')) {
                window.location.href = `elections.html`;
            }
        }

        // Exposer les fonctions globales
        window.closeCandidateModal = closeCandidateModal;
    </script>
</body>

</html>